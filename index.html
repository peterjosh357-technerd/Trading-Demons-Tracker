<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trading Psychology Tracker</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      color: white;
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 1200px; margin: 0 auto; }
    h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    .subtitle { color: #94a3b8; margin-bottom: 2rem; }
    .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
    .stat-card { background: #1e293b; padding: 1.5rem; border-radius: 0.5rem; border: 1px solid #334155; }
    .stat-label { color: #94a3b8; font-size: 0.875rem; margin-bottom: 0.5rem; }
    .stat-value { font-size: 2rem; font-weight: bold; }
    .form-section { background: #1e293b; padding: 1.5rem; border-radius: 0.5rem; border: 1px solid #334155; margin-bottom: 2rem; }
    .form-section h2 { margin-bottom: 1rem; }
    .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem; }
    .form-group { display: flex; flex-direction: column; }
    .form-group label { color: #94a3b8; font-size: 0.875rem; margin-bottom: 0.5rem; }
    .form-group input, .form-group select { 
      background: #334155; 
      color: white; 
      border: none; 
      padding: 0.75rem; 
      border-radius: 0.375rem;
      font-size: 1rem;
    }
    .violations-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 0.5rem; margin-bottom: 1rem; }
    .violation-btn { 
      background: #334155; 
      color: #cbd5e1; 
      border: none; 
      padding: 0.75rem 1rem; 
      border-radius: 0.375rem; 
      cursor: pointer;
      text-align: left;
      font-size: 0.875rem;
      transition: all 0.2s;
    }
    .violation-btn:hover { background: #475569; }
    .violation-btn.active { background: #dc2626; color: white; }
    .add-btn { 
      width: 100%; 
      background: #2563eb; 
      color: white; 
      border: none; 
      padding: 1rem; 
      border-radius: 0.375rem; 
      font-size: 1rem; 
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }
    .add-btn:hover { background: #1d4ed8; }
    .trades-section { background: #1e293b; padding: 1.5rem; border-radius: 0.5rem; border: 1px solid #334155; }
    .trade-item { background: #334155; padding: 1rem; border-radius: 0.375rem; margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: flex-start; }
    .trade-info { flex: 1; }
    .trade-date { color: #94a3b8; font-size: 0.875rem; margin-bottom: 0.25rem; }
    .trade-outcome { 
      display: inline-block; 
      padding: 0.25rem 0.5rem; 
      border-radius: 0.25rem; 
      font-size: 0.75rem; 
      font-weight: 600;
      margin-right: 0.5rem;
    }
    .trade-outcome.win { background: #065f46; color: #6ee7b7; }
    .trade-outcome.loss { background: #7f1d1d; color: #fca5a5; }
    .trade-outcome.breakeven { background: #475569; color: #cbd5e1; }
    .trade-violations { margin-top: 0.5rem; display: flex; flex-wrap: wrap; gap: 0.25rem; }
    .violation-tag { background: #7f1d1d; color: #fca5a5; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; }
    .trade-profit { font-size: 1.25rem; font-weight: bold; white-space: nowrap; margin-left: 1rem; }
    .trade-profit.positive { color: #6ee7b7; }
    .trade-profit.negative { color: #fca5a5; }
    .emotion-label { color: #94a3b8; font-size: 0.75rem; }
  </style>
</head>
<body>
  <div class="container">
    <div>
      <h1>Trading Psychology Tracker</h1>
      <p class="subtitle">Master your mind, master your trades</p>
    </div>

    <div class="stats">
      <div class="stat-card">
        <div class="stat-label">Total Trades</div>
        <div class="stat-value" id="totalTrades">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Clean Trade Rate</div>
        <div class="stat-value" id="cleanRate">0%</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Total Violations</div>
        <div class="stat-value" id="totalViolations">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Avg Violations/Trade</div>
        <div class="stat-value" id="avgViolations">0</div>
      </div>
    </div>

    <div class="form-section">
      <h2>Log New Trade</h2>
      
      <div class="form-grid">
        <div class="form-group">
          <label>Date</label>
          <input type="date" id="tradeDate">
        </div>
        <div class="form-group">
          <label>Outcome</label>
          <select id="tradeOutcome">
            <option value="win">Win</option>
            <option value="loss">Loss</option>
            <option value="breakeven">Break Even</option>
          </select>
        </div>
        <div class="form-group">
          <label>P&L ($)</label>
          <input type="number" step="0.01" id="tradeProfit" value="0">
        </div>
      </div>

      <div class="form-group" style="margin-bottom: 1rem;">
        <label>Pre-Trade Emotional State</label>
        <select id="tradeEmotion">
          <option value="calm">Calm</option>
          <option value="confident">Confident</option>
          <option value="anxious">Anxious</option>
          <option value="fomo">FOMO</option>
          <option value="revenge">Revenge</option>
          <option value="bored">Bored</option>
          <option value="overconfident">Overconfident</option>
        </select>
      </div>

      <div style="margin-bottom: 1rem;">
        <label style="color: #94a3b8; font-size: 0.875rem; display: block; margin-bottom: 0.5rem;">
          Did you violate any of these? (Click all that apply)
        </label>
        <div class="violations-grid" id="violationsGrid"></div>
      </div>

      <button class="add-btn" onclick="addTrade()">Add Trade</button>
    </div>

    <div class="trades-section">
      <h2 style="margin-bottom: 1rem;">Recent Trades</h2>
      <div id="tradesList"></div>
    </div>
  </div>

  <script>
    const traits = [
      { id: 'overtrading', name: 'Overtrading' },
      { id: 'emotional', name: 'Emotional Decision-Making' },
      { id: 'discipline', name: 'Lack of Discipline' },
      { id: 'ignoringMarket', name: 'Ignoring Market Conditions' },
      { id: 'confirmation', name: 'Confirmation Bias' },
      { id: 'cantAcceptLoss', name: 'Inability to Accept Losses' },
      { id: 'overconfidence', name: 'Overconfidence After Wins' },
      { id: 'analysisParalysis', name: 'Analysis Paralysis' },
      { id: 'blaming', name: 'Blaming External Factors' }
    ];

    let trades = [];
    let selectedViolations = [];

    // Initialize
    function init() {
      // Load trades from localStorage
      const saved = localStorage.getItem('tradingTrades');
      if (saved) {
        trades = JSON.parse(saved);
      }

      // Set today's date
      document.getElementById('tradeDate').valueAsDate = new Date();

      // Render violations grid
      const grid = document.getElementById('violationsGrid');
      traits.forEach(trait => {
        const btn = document.createElement('button');
        btn.className = 'violation-btn';
        btn.textContent = trait.name;
        btn.onclick = () => toggleViolation(trait.id, btn);
        grid.appendChild(btn);
      });

      updateStats();
      renderTrades();
    }

    function toggleViolation(id, btn) {
      if (selectedViolations.includes(id)) {
        selectedViolations = selectedViolations.filter(v => v !== id);
        btn.classList.remove('active');
      } else {
        selectedViolations.push(id);
        btn.classList.add('active');
      }
    }

    function addTrade() {
      const trade = {
        id: Date.now(),
        date: document.getElementById('tradeDate').value,
        outcome: document.getElementById('tradeOutcome').value,
        profit: parseFloat(document.getElementById('tradeProfit').value),
        emotion: document.getElementById('tradeEmotion').value,
        violations: [...selectedViolations]
      };

      trades.unshift(trade);
      localStorage.setItem('tradingTrades', JSON.stringify(trades));

      // Reset form
      document.getElementById('tradeDate').valueAsDate = new Date();
      document.getElementById('tradeOutcome').value = 'win';
      document.getElementById('tradeProfit').value = '0';
      document.getElementById('tradeEmotion').value = 'calm';
      
      // Clear violations
      selectedViolations = [];
      document.querySelectorAll('.violation-btn').forEach(btn => btn.classList.remove('active'));

      updateStats();
      renderTrades();
    }

    function updateStats() {
      const totalViolations = trades.reduce((sum, t) => sum + t.violations.length, 0);
      const cleanTrades = trades.filter(t => t.violations.length === 0).length;
      const cleanRate = trades.length > 0 ? ((cleanTrades / trades.length) * 100).toFixed(1) : 0;
      const avgViolations = trades.length > 0 ? (totalViolations / trades.length).toFixed(2) : 0;

      document.getElementById('totalTrades').textContent = trades.length;
      document.getElementById('cleanRate').textContent = cleanRate + '%';
      document.getElementById('totalViolations').textContent = totalViolations;
      document.getElementById('avgViolations').textContent = avgViolations;
    }

    function renderTrades() {
      const list = document.getElementById('tradesList');
      list.innerHTML = '';

      trades.slice(0, 20).forEach(trade => {
        const div = document.createElement('div');
        div.className = 'trade-item';
        
        const profitClass = trade.profit >= 0 ? 'positive' : 'negative';
        
        let violationsHTML = '';
        if (trade.violations.length > 0) {
          violationsHTML = '<div class="trade-violations">';
          trade.violations.forEach(v => {
            const trait = traits.find(t => t.id === v);
            if (trait) {
              violationsHTML += `<span class="violation-tag">${trait.name}</span>`;
            }
          });
          violationsHTML += '</div>';
        }

        div.innerHTML = `
          <div class="trade-info">
            <div class="trade-date">${trade.date} <span class="emotion-label">(${trade.emotion})</span></div>
            <div>
              <span class="trade-outcome ${trade.outcome}">${trade.outcome}</span>
            </div>
            ${violationsHTML}
          </div>
          <div class="trade-profit ${profitClass}">$${trade.profit.toFixed(2)}</div>
        `;
        
        list.appendChild(div);
      });

      if (trades.length === 0) {
        list.innerHTML = '<p style="color: #94a3b8; text-align: center; padding: 2rem;">No trades logged yet. Start tracking!</p>';
      }
    }

    // Initialize on load
    init();
  </script>
</body>
</html>
